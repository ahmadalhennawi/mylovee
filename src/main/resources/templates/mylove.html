<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>عيد ميلادك يا قلبي 🎂💜</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Birthday config (name, birthday YYYY-MM-DD) -->
    <meta name="mylove-name" th:content="${@environment.getProperty('mylove.name','Mein Schatz')}"/>
    <meta name="mylove-birthday" th:content="${@environment.getProperty('mylove.birthday','1996-11-16')}"/>
    <style>
        :root {
          --pink: #ff5f96;
          --lilac: #c084fc;
        }
        * { box-sizing: border-box; }
        body {
          margin: 0;
          font-family: "Tahoma", sans-serif;
          background: radial-gradient(circle at top, #4c1d95 0%, #0f172a 35%, #0f172a 100%);
          color: #fff;
          line-height: 1.7;
          overflow-x: hidden;
          min-height: 100vh;
          position: relative;
        }

        /* FOTO-COLLAGE (zurück!) */
        .bg-collage {
          position: fixed;
          inset: 0;
          z-index: 1; /* über blobs, unter love-layer und content */
          pointer-events: none;
          opacity: .38;
        }
        .bg-photo {
          position: absolute;
          width: 180px;
          height: 120px;
          background-size: cover;
          background-position: center;
          border-radius: 14px;
          box-shadow: 0 10px 25px rgba(0,0,0,.25);
          filter: saturate(1.05);
        }
        .r1 { transform: rotate(-6deg); }
        .r2 { transform: rotate(4deg); }
        .r3 { transform: rotate(-3deg); }
        .r4 { transform: rotate(7deg); }
        .r5 { transform: rotate(-9deg); }

        /* weiche blobs */
        .bg-blob {
          position: fixed;
          border-radius: 9999px;
          filter: blur(80px);
          opacity: 0.35;
          pointer-events: none;
          z-index: 0;
        }
        .blob1 { width: 280px; height: 280px; background: #ff5f96; top: -60px; right: 5%; animation: blob 12s ease-in-out infinite; }
        .blob2 { width: 280px; height: 280px; background: #c084fc; bottom: 5%; left: 10%; animation: blob 15s ease-in-out infinite; }
        @keyframes blob {
          0%,100% { transform: translateY(0) scale(1); }
          50% { transform: translateY(20px) scale(1.1); }
        }

        /* fixes Herz */
        .corner-heart {
          position: fixed;
          top: 25px;
          left: 25px;
          font-size: 30px;
          z-index: 60;
          animation: beat 1.4s ease-in-out infinite;
          filter: drop-shadow(0 0 12px rgba(255,95,150,0.7));
        }
        @keyframes beat {
          0%,100% { transform: scale(1); }
          50% { transform: scale(1.25); }
        }

        header {
          text-align: center;
          padding: 70px 20px 20px;
          position: relative;
          z-index: 5;
        }
        header h1 {
          margin: 0;
          font-size: clamp(2.4rem, 6vw, 3rem);
          background: linear-gradient(90deg, #fff 0%, #ffcfdf 40%, #fff 80%);
          -webkit-background-clip: text;
          color: transparent;
        }
        header p {
          margin-top: 10px;
          color: rgba(255,255,255,0.8);
        }

        .content {
          position: relative;
          z-index: 5;
          max-width: 900px;
          margin: 0 auto;
          padding: 0 20px 70px;
        }

        /* timeline */
        .timeline {
          position: relative;
          margin-top: 35px;
          padding-bottom: 40px;
        }
        .timeline::before {
          content: "";
          position: absolute;
          top: 0;
          right: 50%;
          transform: translateX(50%);
          width: 3px;
          height: 100%;
          background: linear-gradient(180deg, rgba(255,95,150,0), rgba(255,95,150,1), rgba(192,132,252,0));
          filter: drop-shadow(0 0 10px rgba(255,95,150,.4));
        }
        .timeline-item { position: relative; margin-bottom: 30px; opacity: 0; transform: translateY(15px); }
        .timeline-item.show { opacity: 1; transform: translateY(0); transition: .6s ease; }
        .bullet { position: absolute; top: 12px; right: 50%; transform: translate(50%,0); width: 20px; height: 20px; background: radial-gradient(circle, #fff 0%, #ff5f96 60%); border: 3px solid rgba(255,255,255,.3); border-radius: 50%; box-shadow: 0 0 15px rgba(255,95,150,0.8); }
        .timeline-card {
          background: rgba(15, 23, 42, 0.35);
          backdrop-filter: blur(12px);
          border: 1px solid rgba(255,255,255,.08);
          border-radius: 20px;
          padding: 18px 20px 12px;
          width: min(80%, 560px);
          margin: 0 auto;
          box-shadow: 0 10px 30px rgba(0,0,0,.25);
        }
        .timeline-date {
          display: inline-block;
          background: linear-gradient(90deg, #ff5f96, #c084fc);
          color: #fff;
          padding: 5px 14px;
          border-radius: 999px;
          font-size: .8rem;
          margin-bottom: 8px;
        }
        .timeline-text p {
          margin: 4px 0 6px;
          font-size: 1rem;
        }

        /* unterer Bereich */
        #since {
          position: relative;
          z-index: 6;
          text-align: center;
          margin: 60px 0 50px;
          direction: ltr;
        }
        #since h2 {
          background: linear-gradient(90deg,#ff5f96,#c084fc);
          -webkit-background-clip: text;
          color: transparent;
          margin-bottom: 10px;
        }
        #time-total, #her-age {
          display:flex;
          gap:10px;
          flex-wrap:wrap;
          justify-content:center;
          margin-bottom: 25px;
        }
        .count-card {
          background: rgba(15,23,42,0.4);
          border: 1px solid rgba(255,255,255,0.04);
          backdrop-filter: blur(14px);
          border-radius: 14px;
          min-width: 110px;
          padding: 10px 14px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }
        .count-card div {
          font-size: 1.3rem;
          font-weight: bold;
          color: #fff;
        }
        .count-card span {
          font-size: .75rem;
          color: rgba(255,255,255,0.6);
        }

        footer {
          text-align: center;
          color: rgba(255,255,255,0.4);
          font-size: 0.8rem;
          margin-top: 10px;
          padding-bottom: 40px;
        }

        /* layer für die floatenden Elemente (Herzen, Blumen, Ladybug) */
        .love-layer {
          position: fixed;
          inset: 0;
          pointer-events: none;
          z-index: 3;
        }
        .float-love {
          position: absolute;
          bottom: -40px;
          font-size: 26px;
          animation: love-up 6s linear forwards;
          opacity: 0.9;
          filter: drop-shadow(0 0 8px rgba(255,255,255,0.5));
        }
        @keyframes love-up {
          0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; }
          10% { opacity: 1; }
          100% { transform: translateY(-110vh) translateX(30px) rotate(8deg); opacity: 0; }
        }

        @media (max-width: 650px) {
          .timeline::before { right: 15px; transform: none; }
          .bullet { right: 15px; transform: none; }
          .timeline-card { width: calc(100% - 35px); margin-right: 35px; }
          .bg-photo { display: none; }
          .timeline-text p { font-size: 1.05rem; }
        }
    </style>
</head>
<body>
<script>
    try {
      if ('scrollRestoration' in history) { history.scrollRestoration = 'manual'; }
      const toTop = () => window.scrollTo({ top: 0, left: 0, behavior: 'auto' });
      // On first load
      toTop();
      // After DOM ready
      document.addEventListener('DOMContentLoaded', toTop);
      // When returning via back/forward cache
      window.addEventListener('pageshow', (e) => { if (e.persisted) toTop(); });
    } catch (e) {}
</script>
<!-- blobs (ganz hinten) -->
<div class="bg-blob blob1"></div>
<div class="bg-blob blob2"></div>

<!-- FOTO-COLLAGE (wieder da) -->
<div class="bg-collage">
    <div class="bg-photo r1" style="top:5%; left:6%; background-image:url('https://picsum.photos/400/300?1');"></div>
    <div class="bg-photo r2" style="top:20%; left:75%; background-image:url('https://picsum.photos/400/300?2');"></div>
    <div class="bg-photo r3" style="top:55%; left:4%; background-image:url('https://picsum.photos/400/300?3');"></div>
    <div class="bg-photo r4" style="top:70%; left:75%; background-image:url('https://picsum.photos/400/300?4');"></div>
    <div class="bg-photo r5" style="top:35%; left:45%; background-image:url('https://picsum.photos/400/300?5');"></div>
    <div class="bg-photo r2" style="top:82%; left:30%; background-image:url('https://picsum.photos/400/300?6');"></div>
</div>

<div class="corner-heart">💜</div>

<!-- layer für die süßen fliegenden Sachen -->
<div class="love-layer" id="loveLayer"></div>

<header>
    <h1>عيد ميلاد سعيد يا أميرة قلبي 🎂💜</h1>
    <p>من 2016 لليوم... ولسّا إنتِ أحلى حاجة صارت بحياتي.</p>
</header>

<main class="content">
    <section class="timeline" id="timeline">
        <!-- 2016 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2016 – البداية</span>
                <div class="timeline-text">
                    <p>السنة اللي عرفتك فيها… من أوّل كلمة بيناتنا قلبي وقف شوي وقال:</p>
                    <p>«هاي هي… هاي المرأة اللي بدي كمّل معاها عمري.»</p>
                    <p>حسّيتك مو بس بنت، حسّيتك مستقبلي، قدري، وراحة قلبي من جوّا.</p>
                </div>
            </div>
        </div>

        <!-- 2017 -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2017 – حب وخوف</span>
                <div class="timeline-text">
                    <p>سنة مشاعر كلها ملخبطة… شوي نقرّب، شوي نِبعد، شوي نِسكت، شوي نحكي.</p>
                    <p>بس مع كل هالتعب، ما قدرت نهرب منك ولا يوم.</p>
                    <p>كنت نقول بيني وبين روحي: «حتى لو أخاف، قلبي راجع لعندك دايماً.»</p>
                </div>
            </div>
        </div>

        <!-- 2018 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2018 – سند قلبي</span>
                <div class="timeline-text">
                    <p>كنتِ دايماً معي، حتى وأنا يمكن مو دايماً قدّك.</p>
                    <p>تسمعي همومي، وتحملي تعبي، وتواسيني بكلمتين صغار يهزو الدنيا عندي.</p>
                    <p>حسّيت إنّو مهما الدنيا تقسى، في وحدة واقفة ضهري: إنتِ يا لموش.</p>
                </div>
            </div>
        </div>

        <!-- 2019 -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2019 – سكوت بس مو نسيان</span>
                <div class="timeline-text">
                    <p>سنة ما حكينا فيها كتير… المسافات كبرت، والكلام قلّ.</p>
                    <p>بس والله ولا يوم طلعتي من بالي، ولا ليلة نمت من غير ما أتذكرك.</p>
                    <p>كنتي بعيدة عن عيوني، بس كنتِ دايماً جوّا تفكيري وقلبـي.</p>
                </div>
            </div>
        </div>

        <!-- 2020 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2020 – حيرة وظروف</span>
                <div class="timeline-text">
                    <p>الدنيا كانت مقلوبة… ظروفي لخبطتني، حياتي كانت فوضى شوي.</p>
                    <p>بس رغم كل هالضياع، صورتك بقت ثابتة جوّا راسي.</p>
                    <p>كل ما أضيع، قلبي يرجع يتذكّر إنّو في وحدة هناك هي الأمان تاعي… إنتِ.</p>
                </div>
            </div>
        </div>

        <!-- 2021 -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2021 – صبر وانتظار</span>
                <div class="timeline-text">
                    <p>سنة بين شدّ وجذب… كل واحد فينا بمكان، بس القلوب مربوطة ببعض.</p>
                    <p>كنّا يمكن نحاول نكمّل حياتنا، بس كل ما نرجع نهدى، نرجع نفكّر ببعض من جديد.</p>
                    <p>كان كأنّو ربّي عم يعلّمنا الصبر قبل ما يجمعنا صح.</p>
                </div>
            </div>
        </div>

        <!-- 2022 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2022 – فهمت إنّك نصيبي</span>
                <div class="timeline-text">
                    <p>في 2022 حسّيت بشي واضح جوّا قلبي:</p>
                    <p>«هاي البنت مو مرور عابر… هاي قدري.»</p>
                    <p>فهمت إنّك الكنز اللي ربّي حطّه بيدي، ولازم ما أضيّعك ولا أفرّط فيك مهما صار.</p>
                </div>
            </div>
        </div>

        <!-- 2023 -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2023 – الحب تضاعف</span>
                <div class="timeline-text">
                    <p>الحب بهي السنة صار غير… حسّيته أعمق، أنضج، أقوى.</p>
                    <p>صرت مقتنع من قلبي: «مستحيل بحياتي أحب حدا مثل ما أحببتك إنتِ.»</p>
                    <p>صار عندي يقين إنّك حبيبتي، وصاحبتي، ووطن قلبي كله.</p>
                </div>
            </div>
        </div>

        <!-- 2024 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2024 – أوّل لقاء وروح رجعت تعيش</span>
                <div class="timeline-text">
                    <p>هاي السنة اللي شفتك فيها وجهاً لوجه… أول لقاء بيناتنا.</p>
                    <p>والله كأني رجعت تولّدت من جديد بس شفت عيونك قدّامي.</p>
                    <p>بآخر 2024 رجعت لعندك لأنّي عنجد ما عاد قدرت أتحمّل فكرة حياة بلاك… قلبي اختار ورجع لك.</p>
                </div>
            </div>
        </div>

        <!-- أواخر 2024 / بداية 2025: رجعة قوية -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">نهاية 2024 – رجوعي لعندك</span>
                <div class="timeline-text">
                    <p>بنهاية 2024 حسّيت إنّي مهما حاولت أكون قوي… بدونك أنا ولا شي.</p>
                    <p>رجعت لعندك بقلبي كامل، مو نص نص، وقررت قدّامي إنّو ما أتركك مرّة تانية.</p>
                    <p>من هداك اليوم وأنا شايف مستقبلي مرتبط بإيدك وإنتِ حدّي.</p>
                </div>
            </div>
        </div>

        <!-- 2025 -->
        <div class="timeline-item" data-anim="anim-slide-right">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2025 – أصعب سنة وصبر المسافات</span>
                <div class="timeline-text">
                    <p>2025 يمكن أصعب سنة عليّ… لأني حاسس فيك، حاسس بحبك، بس ما زلتي بعيدة.</p>
                    <p>أصعب شعور إنّو روحك تكون معاي، بس جسمك لسا مو جنبي.</p>
                    <p>بس مع كل هالألم، تعلّمت إنّو الصبر طريقنا لنلتقي، وإنّو كل يوم يمر يقرّبنا من بعض أكثر.</p>
                </div>
            </div>
        </div>

        <!-- 2026 -->
        <div class="timeline-item" data-anim="anim-slide-left">
            <div class="bullet"></div>
            <div class="timeline-card">
                <span class="timeline-date">2026 – سنة الذهب وحياتنا الجديدة (إن شاء الله)</span>
                <div class="timeline-text">
                    <p>2026 هي السنة اللي بدّي ياها تكون ذهبية… سنة اجتماعنا الحقيقي إن شاء الله.</p>
                    <p>سنة نبدأ فيها حياتنا الجديدة تحت سقف واحد، بقلب واحد، بطريق واحد.</p>
                    <p>من 2016 لـ 2026… وكل هالسنين ما كانت إلا تجهيز للي رح نعيشه سوا لباقي العمر، بحب نظيف، إحترام، ومشاعر ما تنتهي.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="since">
        <h2>مع بعض من 16 أبريل 2016 💜</h2>
        <p style="margin-bottom:18px; color:rgba(255,255,255,0.7);">هدا الوقت كلووو وقلبي كل يوم يناجيكي: بحبك ❤️</p>
        <div id="time-total">
            <div class="count-card">
                <div id="years">0</div>
                <span>سنة</span></div>
            <div class="count-card">
                <div id="days">0</div>
                <span>يوم</span></div>
            <div class="count-card">
                <div id="hours">0</div>
                <span>ساعة</span></div>
            <div class="count-card">
                <div id="minutes">0</div>
                <span>دقيقة</span></div>
            <div class="count-card">
                <div id="seconds">0</div>
                <span>ثانية</span></div>
        </div>
        <h3 style="color:#fff;margin-bottom:8px;">⏳ بحبك بكبر الرقم يلي رح تتعبـي لتقريه</h3>

        <h3 style="color:#fff;margin-bottom:8px; margin-top:25px;">🎂 عمر الوردة</h3>
        <div id="her-age">
            <div class="count-card">
                <div id="ageYears">0</div>
                <span>سنة</span></div>
            <div class="count-card">
                <div id="ageMonths">0</div>
                <span>شهر</span></div>
            <div class="count-card">
                <div id="ageDays">0</div>
                <span>يوم</span></div>
        </div>
    </section>

    <footer>
        من ألمانيا للجزائر: نحبك 🎂💜
    </footer>
</main>

<!-- scroll reveal -->
<script>
    const items = document.querySelectorAll(".timeline-item");
    const observer = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          entry.target.classList.add("show");
          observer.unobserve(entry.target);
        }
      });
    },{threshold:0.4});
    items.forEach(i=>observer.observe(i));
</script>

<!-- Zähler -->
<script>
    // 16 أبريل 2016
    const startDate = new Date(2016, 3, 16);
    const birthDate = new Date(1996, 10, 16);

    function updateCounts(){
      const now = new Date();
      const diffMs = now - startDate;
      const totalSeconds = Math.floor(diffMs / 1000);
      const totalMinutes = Math.floor(totalSeconds / 60);
      const totalHours   = Math.floor(totalMinutes / 60);
      const totalDays    = Math.floor(totalHours / 24);
      const years        = Math.floor(totalDays / 365);

      document.getElementById("years").textContent   = years.toLocaleString("ar");
      document.getElementById("days").textContent    = totalDays.toLocaleString("ar");
      document.getElementById("hours").textContent   = totalHours.toLocaleString("ar");
      document.getElementById("minutes").textContent = totalMinutes.toLocaleString("ar");
      document.getElementById("seconds").textContent = totalSeconds.toLocaleString("ar");

      let ay = now.getFullYear() - birthDate.getFullYear();
      let am = now.getMonth() - birthDate.getMonth();
      let ad = now.getDate() - birthDate.getDate();
      if (ad < 0) {
        const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);
        ad += prevMonth.getDate();
        am--;
      }
      if (am < 0) {
        am += 12;
        ay--;
      }
      document.getElementById("ageYears").textContent = ay.toLocaleString("ar");
      document.getElementById("ageMonths").textContent = am.toLocaleString("ar");
      document.getElementById("ageDays").textContent = ad.toLocaleString("ar");
    }
    updateCounts();
    setInterval(updateCounts, 1000);
</script>

<!-- langsame schwebende Herzen / Blumen / Ladybugs -->
<script>
    const loveLayer = document.getElementById("loveLayer");
    const floatEmojis = ["💜", "💗", "🌸","🐞" ,"💖", "💘", "💝", "💞", "💓" ,"🐞","💕" ,"💌", "❤️", "😚" ,"😻","🐞"];

    function spawnLove() {
      const el = document.createElement("div");
      el.className = "float-love";
      el.textContent = floatEmojis[Math.floor(Math.random() * floatEmojis.length)];

      const size = 22 + Math.random() * 22;
      el.style.fontSize = size + "px";
      el.style.left = Math.random() * 100 + "%";

      const duration = 9 + Math.random() * 6;
      el.style.animationDuration = duration + "s";

      el.style.transform = `translateX(${(Math.random() - 0.5) * 30}px)`;

      loveLayer.appendChild(el);
      setTimeout(() => el.remove(), duration * 1000);
    }
    setInterval(spawnLove, 1200);
</script>

<!-- Klick-Herzen -->
<script>
    const loveWords = [
      "بحبك 💜",
      "مشتقتلك 💗",
      "قلبي معاك ❤️",
      "حياتي 🌸",
      "روحي 💞",
      "أجمل حاجة صارتلي 💐",
      "أحبك للأبد 💜",
      "❤️",
      "💜","فكي الحظر" ,"ردي عليي"
    ];

    document.addEventListener("click", function (e) {
      const word = document.createElement("div");
      word.textContent = loveWords[Math.floor(Math.random() * loveWords.length)];
      word.style.position = "fixed";
      word.style.left = e.clientX + "px";
      word.style.top = e.clientY + "px";
      word.style.fontSize = (16 + Math.random() * 10) + "px";
      word.style.fontWeight = "bold";
      word.style.color = ["#ff5f96", "#c084fc", "#ffb3c6", "#ff99cc"][Math.floor(Math.random() * 4)];
      word.style.userSelect = "none";
      word.style.pointerEvents = "none";
      word.style.transition = "transform 2.2s ease-out, opacity 2.2s ease-out";
      word.style.zIndex = 9999;
      word.style.rotate = (Math.random() * 20 - 10) + "deg";
      document.body.appendChild(word);

      const moveX = (Math.random() - 0.5) * 100;
      const moveY = -120 - Math.random() * 80;

      setTimeout(() => {
        word.style.transform = `translate(${moveX}px, ${moveY}px) scale(${1.2 + Math.random() * 0.3})`;
        word.style.opacity = "0";
      }, 10);

      setTimeout(() => word.remove(), 2200);
    });
</script>

<!-- Mini-ETA-Badge (wird automatisch versteckt, wenn <= 60s) -->
<div id="bd-eta-pill" aria-live="polite" title="كم تبقّى لبدء العرض؟">
    <span class="bd-eta-label">باقي:</span>
    <span id="bdEtaText">—</span>
</div>

<style>
    #bd-eta-pill{
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 70;
      background: rgba(15,23,42,0.55);
      border: 1px solid rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      color: #fff;
      padding: 8px 12px;
      border-radius: 999px;
      font-size: .9rem;
      box-shadow: 0 8px 20px rgba(0,0,0,.25);
    }
    #bd-eta-pill.hidden{ display:none; }
    #bd-eta-pill .bd-eta-label{
      background: linear-gradient(90deg,#ff5f96,#c084fc);
      -webkit-background-clip: text; color: transparent;
      font-weight: 700; margin-inline-end: 6px;
    }
</style>

<!-- Birthday overlay + fireworks (HTML container) -->
<div id="birthday-overlay" style="display:none;">
    <div class="bd-content">
        <div class="bd-count">60</div>
        <div class="bd-msg"></div>
    </div>
    <canvas id="fireworks-canvas"></canvas>
</div>

<!-- زر تجربة العدّ التنازلي -->
<button id="test-birthday-btn" title="زر التجربة">تجربة 🎆</button>

<!-- Optional: real song file (place file at static/audio/happy-birthday.mp3) -->
<audio id="bd-audio-file" src="/audio/happy-birthday.mp3" preload="auto" loop style="display:none"></audio>

<!-- Mini-Badge Logik: zeigt verbleibende Zeit bis zur letzten Minute -->
<script>
    // ==== Mini-Badge bis zur letzten Minute, dann ausblenden (Overlay übernimmt) ====
    (function(){
      const meta = (name) => { const m = document.querySelector(`meta[name="${name}"]`); return (m && m.content) ? m.content.trim() : ""; };
      const BIRTHDAY_STR = meta('mylove-birthday') || '1996-11-16';
      const parts = BIRTHDAY_STR.split('-');
      if (parts.length !== 3) return;
      const BY = parseInt(parts[0],10), BM = parseInt(parts[1],10), BD = parseInt(parts[2],10);
      if (!BY || !BM || !BD) return;

      const pill = document.getElementById('bd-eta-pill');
      const txt  = document.getElementById('bdEtaText');
      if (!pill || !txt) return;

      const birthdayOfYear = (year) => { const d = new Date(year, BM - 1, BD); d.setHours(0,0,0,0); return d; };
      const nextBirthdayMidnight = (now) => { const thisYear = birthdayOfYear(now.getFullYear()); return (thisYear > now) ? thisYear : birthdayOfYear(now.getFullYear() + 1); };

      function fmtRemaining(sec){
        const d = Math.floor(sec / 86400); sec %= 86400;
        const h = Math.floor(sec / 3600); sec %= 3600;
        const m = Math.floor(sec / 60);
        if (d > 0) return `${d.toLocaleString('ar')} يوم ${h.toLocaleString('ar')} ساعة`;
        if (h > 0) return `${h.toLocaleString('ar')} ساعة ${m.toLocaleString('ar')} دقيقة`;
        return `${m.toLocaleString('ar')} دقيقة`;
      }

      function tick(){
        const now = new Date();
        const target = nextBirthdayMidnight(now);
        let diff = Math.floor((target - now) / 1000);
        if (diff <= 60) { pill.classList.add('hidden'); }
        else { pill.classList.remove('hidden'); txt.textContent = fmtRemaining(diff); pill.setAttribute('aria-label', `باقي ${txt.textContent} لبدء العرض`); }
      }

      tick();
      const id = setInterval(tick, 15000);
      document.addEventListener('visibilitychange', () => { if (document.hidden) { try { clearInterval(id); } catch {} } });
    })();
</script>

<!-- Feature script (dein großes birthday.js mit Feuerwerk usw.) -->
<script src="/js/birthday.js"></script>
</body>
</html>
